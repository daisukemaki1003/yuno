# 未使用コード・無駄な実装の調査レポート

## 調査概要

servicesフォルダ内のコードベースを調査し、未使用の機能、無駄な実装、削除可能なコードを特定しました。

## 削除推奨項目

### 1. 完全に未使用のファイル

#### 📁 `/services/src/schemas/domain/bot.ts`
- **削除理由**: 
  - ファイル全体が一度もインポートされていない
  - 定義されているスキーマ（BotStatusSchema、MeetingIdSchema等）が使用されていない
  - 実際のアプリケーションは`meetingbaas.client.types.ts`の型定義を使用している
  - ドメインモデルとして設計されたが、実装時に別の型定義が採用された可能性が高い

#### 📁 `/services/test/hoge/hoge.test.ts`
- **削除理由**:
  - プレースホルダーとして作成されたテストファイル
  - 実際のテストロジックが含まれていない（`expect(true).toBe(true)`のみ）
  - "hoge"という日本語のプレースホルダー名が使われている
  - 他に適切な単体テストが存在する

### 2. 未使用の関数・エクスポート

#### 🔧 `/services/src/services/meetingbaas.service.ts`
- **削除対象**: `hasUserMeetingBaasAccess`関数（39-43行目）
- **削除理由**:
  - エクスポートされているが、どこからもインポートされていない
  - TODO コメントで「replace with key-store」とあり、将来的な実装待ちの状態
  - 現在は常に`true`を返すだけの仮実装

#### 🔧 `/services/src/utils/logger.ts`
- **削除対象**: 
  - `log`インスタンス（157行目）
  - `LogLevel`型（9-11行目）
  - `LogMeta`インターフェース（13-15行目）
  - `LogEntry`インターフェース（17-22行目）
- **削除理由**:
  - これらのエクスポートは一度もインポートされていない
  - Loggerクラスは各所でインスタンス化して使用されている
  - 型定義は内部的にのみ使用されており、外部公開の必要がない

#### 🔧 `/services/src/utils/errors.ts`
- **削除対象の検討**: 
  - `HttpError`クラス（6-16行目）
  - `ErrorResponse`インターフェース（21-28行目）
  - `toHttpResponse`関数（55行目）
- **削除理由**:
  - 直接インポートされていない（ヘルパー関数経由でのみ使用）
  - 内部実装として隠蔽可能

#### 🔧 `/services/src/clients/http.client.ts`
- **削除対象**: `post`メソッド（188-198行目）
- **削除理由**:
  - 実装されているが一度も使用されていない
  - すべてのHTTPリクエストは`fetchJson`メソッドを直接使用している

### 3. コメントアウトされたコード

#### 📝 `/services/src/routes/_router.ts`
- **削除対象**: コメントアウトされた例（30-33行目）
```typescript
// Add more route modules here as they are created
// Example:
// router.route('/bots', botsRouter);
// router.route('/meetings', meetingsRouter);
```
- **削除理由**:
  - 実際のルーター実装は`v1.router.ts`で行われている
  - 例として残す必要性が低い

## 削除しない方が良い項目

### 1. `package.prod.json`
- **理由**: `pack`スクリプトで本番用の最小限のpackage.jsonとして使用されている
- **用途**: Cloud Functions等へのデプロイ時に必要

### 2. `v1-api-test.md`
- **理由**: API手動テストのドキュメントとして有用
- **用途**: 開発者がAPIをテストする際の参考資料

### 3. TODOコメント
- **理由**: 将来の実装予定を示す重要な情報
- **例**: Key Store統合の予定など

## 推奨される整理手順

1. **即座に削除可能**:
   - `src/schemas/domain/bot.ts`
   - `test/hoge/hoge.test.ts`
   - コメントアウトされたルーター例

2. **確認後に削除**:
   - 未使用の関数・メソッド（`hasUserMeetingBaasAccess`、`post`）
   - 未使用のエクスポート（logger.tsの型定義等）

3. **リファクタリング検討**:
   - `HttpError`関連のエクスポートを内部実装に変更
   - `LoggerOptions`を内部型に変更

## 削除による影響

### メリット
- コードベースの可読性向上
- メンテナンスコストの削減
- ビルドサイズの軽微な削減
- 新規開発者の混乱を防ぐ

### リスク
- 将来的に必要になる可能性があるコードの削除
- 外部から参照されている可能性（npmパッケージとして公開されている場合）

## 結論

上記の削除推奨項目を整理することで、コードベースは約**300行**程度削減され、より管理しやすくなります。特に未使用のドメインスキーマファイルは混乱の元になるため、優先的に削除することを推奨します。

ただし、削除前には以下を確認することを推奨します：
1. このサービスが他のプロジェクトから参照されていないか
2. 削除予定のコードに関連するドキュメントがないか
3. チーム内で共有されている設計意図がないか