# 議事録自動生成 I/O 仕様（最終版）

最終更新日: 2025-09-23

> 前提: 会議開始～最初の 1 分間は「議事録生成中」を表示。

---

## 1) 30 秒ディジェスト（生成＆抽出）: **Delta30s**（出力）

| フィールド |         型 | 必須 | 説明                                          | 例                                                           |
| ---------- | ---------: | :--: | --------------------------------------------- | ------------------------------------------------------------ |
| summaries  |   文字列[] |  ✅  | 話題ごとの短い要約（1 要約=1 トピックの短文） | 「公開最終版は来週水曜に確定」「Figma 資料を最新化して共有」 |
| actions    |   Action[] |  ✅  | 30 秒内に抽出されたタスク                     | 下表参照                                                     |
| decisions  | Decision[] | 任意 | 決定事項（あれば）                            | 「公開日＝来週水曜に決定」                                   |
| questions  | Question[] | 任意 | 不明点・確認事項（あれば）                    | 「最終承認者は誰か」                                         |

**Action（タスク）**

| フィールド |               型 | 必須 | 説明                                                      | 例                     |
| ---------- | ---------------: | :--: | --------------------------------------------------------- | ---------------------- |
| owner      |           文字列 | 任意 | 担当者名（未確定なら空）                                  | 山田                   |
| task       |           文字列 |  ✅  | やること（短文）                                          | レビューを集約して返信 |
| due        | 日付(YYYY-MM-DD) | 任意 | 期限（相対表現を絶対日付に正規化）                        | 2025-09-21             |
| confidence |              0–1 | 任意 | 抽出の確からしさ（監視/自動フィルタ用。不要なら未使用可） | 0.86                   |

**Decision**

| フィールド |     型 | 必須 | 説明         | 例                 |
| ---------- | -----: | :--: | ------------ | ------------------ |
| what       | 文字列 |  ✅  | 何を決めたか | 公開最終版の確定日 |
| reason     | 文字列 |  ✅  | 背景・理由   | 来週水曜に決定     |

**Question**

| フィールド         |                 型 | 必須 | 説明                         | 例                         |
| ------------------ | -----------------: | :--: | ---------------------------- | -------------------------- |
| topic              |             文字列 |  ✅  | 何を確認・詰める必要があるか | 公開判定の最終責任者は誰か |
| related_section_id |             文字列 | 任意 | 紐づくセクション ID          | sec_publish_schedule       |
| priority           | 列挙(low/mid/high) | 任意 | 優先度                       | mid                        |
| confidence         |                0–1 | 任意 | 抽出の確からしさ             | 0.72                       |

---

## 2) セクション更新（入力: 現状 + Delta30s → **変更分のみ**出力）

### 入力: **CurrentSectionList**（最小）

> **status が `closed` のセクションは含めない**。

| フィールド |        型 | 必須 | 説明                                    |
| ---------- | --------: | :--: | --------------------------------------- |
| meeting_id |    文字列 |  ✅  | 会議 ID                                 |
| sections   | Section[] |  ✅  | 現在のセクション一覧（`closed` は除外） |

**Section（入力側の最小項目）**

| フィールド |       型 | 必須 | 説明                                           |
| ---------- | -------: | :--: | ---------------------------------------------- |
| id         |   文字列 |  ✅  | セクション ID（安定な識別子）                  |
| title      |   文字列 |  ✅  | セクション名（2–4 語推奨）                     |
| status     |     列挙 |  ✅  | `active` / `provisional`                       |
| bullets    | 文字列[] |  ✅  | 代表要点（最新 3–5 行）                        |
| actions    | Action[] | 任意 | 既存アクション（重複統合のため渡せるなら推奨） |

---

### 出力: **SectionUpdateResponse**（変更されたセクションのみ）

| フィールド       |           型 | 必須 | 説明                                            | 例                |
| ---------------- | -----------: | :--: | ----------------------------------------------- | ----------------- |
| meeting_id       |       文字列 |  ✅  | 会議 ID                                         | mtg_20250921_1000 |
| changed_sections |    Section[] |  ✅  | **新規/更新/クローズ**のセクションのみ          | 2 件              |
| change_summary   | オブジェクト |  ✅  | 簡易ログ（ID のみ。`action_events` は含めない） | 下表              |

**changed_sections の Section（出力側の項目）**

| フィールド |       型 | 必須 | 説明                                           |
| ---------- | -------: | :--: | ---------------------------------------------- |
| id         |   文字列 |  ✅  | セクション ID                                  |
| title      |   文字列 |  ✅  | セクション名                                   |
| status     |     列挙 |  ✅  | `provisional` / `active` / `closed`            |
| bullets    | 文字列[] |  ✅  | 更新後の最新要点（最大 3–5 行）                |
| actions    | Action[] |  ✅  | 更新後のタスク一覧（重複統合・期限正規化済み） |

**change_summary**（ID のみ簡易記録）

| フィールド       |       型 | 必須 | 説明                        | 例                       |
| ---------------- | -------: | :--: | --------------------------- | ------------------------ |
| created_sections | 文字列[] |  ✅  | 新規作成されたセクション ID | ["sec_figma_update"]     |
| updated_sections | 文字列[] |  ✅  | 更新のみのセクション ID     | ["sec_publish_schedule"] |
| closed_sections  | 文字列[] |  ✅  | クローズしたセクション ID   | []                       |

---

## 3) 最小フロー（I/O のみ）

| ステップ               | 入力                          | 出力                                    |
| ---------------------- | ----------------------------- | --------------------------------------- |
| A. Delta 生成（30 秒） | 30 秒の ASR テキスト          | **Delta30s**                            |
| B. セクション更新      | CurrentSectionList + Delta30s | **SectionUpdateResponse（変更分のみ）** |

---

## 4) 参考ミニ例（抜粋）

**Delta30s**

- summaries:
  - 公開最終版は来週水曜に確定
  - Figma 資料を最新化して共有
  - レビューを集約して本日中に返信
- actions:
  - owner:"" / task:"Figma 資料を最新化して共有" / due:null
  - owner:"" / task:"レビューを集約して返信" / due:"2025-09-21"

**SectionUpdateResponse**

- changed_sections:
  - sec_publish_schedule … bullets に「来週水曜に確定」を追加
  - sec_figma_update … 新規作成（action 追加）
- change_summary:
  - created_sections: ["sec_figma_update"]
  - updated_sections: ["sec_publish_schedule"]
  - closed_sections: []

---

### 補足（仕様安定のための推奨）

- `Action.confidence` / `Question.confidence` は運用で不要なら非表示可（I/F 上は任意項目）。
- `CurrentSectionList.sections` は **`closed` を除外**して渡すこと（ルーティングの誤吸収を防止）。
- `changed_sections` のみ差分適用することで UI 更新コストを最小化。
